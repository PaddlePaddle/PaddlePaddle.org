<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div itemprop="articleBody">
<div class="section" id="select-op-design">
<span id="select-op-design"></span><h1>select_op Design<a class="headerlink" href="#select-op-design" title="永久链接至标题">¶</a></h1>
<div class="section" id="introduction">
<span id="introduction"></span><h2>Introduction<a class="headerlink" href="#introduction" title="永久链接至标题">¶</a></h2>
<p>In golang, the <a class="reference external" href="https://golang.org/ref/spec#Select_statements"><strong>select</strong></a>
statement lets a goroutine wait on multiple communication operations at the
same time. The <strong>select</strong> blocks until one of its cases can run, then
executes the case.  If multiple cases are ready to run, then one case is
choosen at random to be executed.</p>
<p>With the introduction of CSP for Paddle, we mimic this behavior by
creating a <strong><em>select_op</em></strong>.</p>
</div>
<div class="section" id="how-to-use-it">
<span id="how-to-use-it"></span><h2>How to use it<a class="headerlink" href="#how-to-use-it" title="永久链接至标题">¶</a></h2>
<p>The <strong>select_op</strong> is available as a c++ operator.  However most users
will prefer to use the much simplier Python API.</p>
<ul class="simple">
<li><strong>fluid.Select()</strong>: Creates a select operator and adds it to the current
block within the main program.  Also creates a sub block and adds it to the
main program.  This sub block is used to hold all variables and operators
used by the case statements.</li>
</ul>
<p>Within the select block, users can add cases by
calling <strong>select.case</strong> or <strong>select.default</strong> method.</p>
<ul class="simple">
<li><strong>fluid.Select.case(channel_action, channel, result_variable)</strong>: Represents
a fluid channel send/recv case.  This method creates a SelectCase block
guard and adds it to the Select block.  The arguments into this method tells
the select which channel operation to listen to.</li>
<li><strong>fluid.Select.default()</strong>: Represents the fluid default case.  This default
case is executed if none of the channel send/recv cases are available to
execute.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ch1</span> <span class="o">=</span> <span class="n">fluid</span><span class="o">.</span><span class="n">make_channel</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">core</span><span class="o">.</span><span class="n">VarDesc</span><span class="o">.</span><span class="n">VarType</span><span class="o">.</span><span class="n">LOD_TENSOR</span><span class="p">)</span>
<span class="n">quit_ch</span> <span class="o">=</span> <span class="n">fluid</span><span class="o">.</span><span class="n">make_channel</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">core</span><span class="o">.</span><span class="n">VarDesc</span><span class="o">.</span><span class="n">VarType</span><span class="o">.</span><span class="n">LOD_TENSOR</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">fill_constant</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">core</span><span class="o">.</span><span class="n">VarDesc</span><span class="o">.</span><span class="n">VarType</span><span class="o">.</span><span class="n">INT32</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">fill_constant</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">core</span><span class="o">.</span><span class="n">VarDesc</span><span class="o">.</span><span class="n">VarType</span><span class="o">.</span><span class="n">INT32</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">while_cond</span> <span class="o">=</span> <span class="n">fill_constant</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">core</span><span class="o">.</span><span class="n">VarDesc</span><span class="o">.</span><span class="n">VarType</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">while_op</span> <span class="o">=</span> <span class="n">While</span><span class="p">(</span><span class="n">cond</span><span class="o">=</span><span class="n">while_cond</span><span class="p">)</span>    

<span class="k">with</span> <span class="n">while_op</span><span class="o">.</span><span class="n">block</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">fluid</span><span class="o">.</span><span class="n">Select</span><span class="p">()</span> <span class="k">as</span> <span class="n">select</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">select</span><span class="o">.</span><span class="n">case</span><span class="p">(</span><span class="n">fluid</span><span class="o">.</span><span class="n">channel_send</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
            <span class="c1"># Send x, then perform Fibonacci calculation on x and y</span>
            <span class="n">x_tmp</span> <span class="o">=</span> <span class="n">fill_constant</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">core</span><span class="o">.</span><span class="n">VarDesc</span><span class="o">.</span><span class="n">VarType</span><span class="o">.</span><span class="n">INT32</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">assign</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">x_tmp</span><span class="p">)</span>
            <span class="n">assign</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
            <span class="n">assign</span><span class="p">(</span><span class="n">elementwise_add</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_tmp</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">),</span> <span class="n">output</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">select</span><span class="o">.</span><span class="n">case</span><span class="p">(</span><span class="n">fluid</span><span class="o">.</span><span class="n">channel_recv</span><span class="p">,</span> <span class="n">quit_channel</span><span class="p">,</span> <span class="n">result2</span><span class="p">):</span>
            <span class="c1"># Exit out of While loop</span>
            <span class="n">while_false</span> <span class="o">=</span> <span class="n">fill_constant</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">core</span><span class="o">.</span><span class="n">VarDesc</span><span class="o">.</span><span class="n">VarType</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">helper</span> <span class="o">=</span> <span class="n">layer_helper</span><span class="o">.</span><span class="n">LayerHelper</span><span class="p">(</span><span class="s1">'assign'</span><span class="p">)</span>
            <span class="n">helper</span><span class="o">.</span><span class="n">append_op</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">'assign'</span><span class="p">,</span>
                <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s1">'X'</span><span class="p">:</span> <span class="p">[</span><span class="n">while_false</span><span class="p">]},</span>
                <span class="n">outputs</span><span class="o">=</span><span class="p">{</span><span class="s1">'Out'</span><span class="p">:</span> <span class="p">[</span><span class="n">while_cond</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="section" id="how-it-works">
<span id="how-it-works"></span><h2>How it Works<a class="headerlink" href="#how-it-works" title="永久链接至标题">¶</a></h2>
<div class="section" id="program-description">
<span id="program-description"></span><h3>Program Description<a class="headerlink" href="#program-description" title="永久链接至标题">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">blocks</span> <span class="p">{</span>
  <span class="n">idx</span><span class="p">:</span> <span class="mi">0</span>
  <span class="o">...</span>
  <span class="o">//</span> <span class="n">Create</span> <span class="s2">"case_to_execute"</span> <span class="n">variable</span>
  <span class="n">ops</span> <span class="p">{</span>
    <span class="n">outputs</span> <span class="p">{</span>
      <span class="n">parameter</span><span class="p">:</span> <span class="s2">"Out"</span>
      <span class="n">arguments</span><span class="p">:</span> <span class="s2">"fill_constant_110.tmp_0"</span>
    <span class="p">}</span>
    <span class="nb">type</span><span class="p">:</span> <span class="s2">"fill_constant"</span>
    <span class="n">attrs</span> <span class="p">{</span>
      <span class="n">name</span><span class="p">:</span> <span class="s2">"force_cpu"</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">BOOLEAN</span>
      <span class="n">b</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">}</span>
    <span class="n">attrs</span> <span class="p">{</span>
      <span class="n">name</span><span class="p">:</span> <span class="s2">"value"</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">FLOAT</span>
      <span class="n">f</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="p">}</span>
    <span class="n">attrs</span> <span class="p">{</span>
      <span class="n">name</span><span class="p">:</span> <span class="s2">"shape"</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">INTS</span>
      <span class="n">ints</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
    <span class="n">attrs</span> <span class="p">{</span>
      <span class="n">name</span><span class="p">:</span> <span class="s2">"dtype"</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">INT</span>
      <span class="n">i</span><span class="p">:</span> <span class="mi">2</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="o">//</span> <span class="n">Create</span> <span class="s2">"select"</span> <span class="n">operator</span><span class="o">.</span>
  <span class="o">//</span> <span class="n">inputs</span><span class="p">:</span>
  <span class="o">//</span>   <span class="n">X</span><span class="p">:</span> <span class="n">All</span> <span class="nb">input</span> <span class="n">variables</span> <span class="n">used</span> <span class="n">by</span> <span class="n">operators</span> <span class="n">within</span> <span class="n">the</span> <span class="n">select</span> <span class="n">block</span>
  <span class="o">//</span>   <span class="n">case_to_execute</span><span class="p">:</span> <span class="n">Variable</span> <span class="n">filled</span> <span class="ow">in</span> <span class="n">by</span> <span class="n">select_op</span> <span class="n">when</span> <span class="n">it</span> <span class="n">determines</span>
  <span class="o">//</span>     <span class="n">which</span> <span class="n">case</span> <span class="n">to</span> <span class="n">execute</span><span class="o">.</span>
  <span class="o">//</span>  
  <span class="o">//</span> <span class="n">outputs</span><span class="p">:</span>
  <span class="o">//</span>   <span class="n">Out</span><span class="p">:</span> <span class="n">All</span> <span class="n">output</span> <span class="n">variables</span> <span class="n">referenced</span> <span class="n">by</span> <span class="n">operators</span> <span class="n">within</span> <span class="n">select</span> <span class="n">block</span><span class="o">.</span>
  <span class="o">//</span>
  <span class="o">//</span> <span class="n">attrs</span><span class="p">:</span>
  <span class="o">//</span>   <span class="n">sub_block</span><span class="p">:</span> <span class="n">The</span> <span class="n">block</span> <span class="nb">id</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">select</span> <span class="s2">"cases"</span>
  <span class="o">//</span>   <span class="n">cases</span><span class="p">:</span>  <span class="n">Serialized</span> <span class="nb">list</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">cases</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">select</span> <span class="n">op</span><span class="o">.</span>
  <span class="o">//</span>     <span class="n">Each</span> <span class="n">case</span> <span class="ow">is</span> <span class="n">serialized</span> <span class="k">as</span><span class="p">:</span> <span class="s1">'&lt;index&gt;,&lt;type&gt;,&lt;channel&gt;,&lt;value&gt;'</span>
  <span class="o">//</span>     <span class="n">where</span> <span class="nb">type</span> <span class="ow">is</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">default</span><span class="p">,</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">send</span><span class="p">,</span> <span class="ow">and</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">receive</span><span class="o">.</span>
  <span class="o">//</span>     <span class="n">No</span> <span class="n">channel</span> <span class="ow">and</span> <span class="n">values</span> <span class="n">are</span> <span class="n">needed</span> <span class="k">for</span> <span class="n">default</span> <span class="n">cases</span><span class="o">.</span>
  <span class="n">ops</span> <span class="p">{</span>
    <span class="n">inputs</span> <span class="p">{</span>
      <span class="n">parameter</span><span class="p">:</span> <span class="s2">"X"</span>
      <span class="n">arguments</span><span class="p">:</span> <span class="s2">"fill_constant_103.tmp_0"</span>
      <span class="n">arguments</span><span class="p">:</span> <span class="s2">"fill_constant_104.tmp_0"</span>
    <span class="p">}</span>
    <span class="n">inputs</span> <span class="p">{</span>
      <span class="n">parameter</span><span class="p">:</span> <span class="s2">"case_to_execute"</span>
      <span class="n">arguments</span><span class="p">:</span> <span class="s2">"fill_constant_110.tmp_0"</span>
    <span class="p">}</span>
    <span class="n">outputs</span> <span class="p">{</span>
      <span class="n">parameter</span><span class="p">:</span> <span class="s2">"Out"</span>
      <span class="n">arguments</span><span class="p">:</span> <span class="s2">"fill_constant_110.tmp_0"</span>
    <span class="p">}</span>    
    <span class="nb">type</span><span class="p">:</span> <span class="s2">"select"</span>
    <span class="n">attrs</span> <span class="p">{</span>
      <span class="n">name</span><span class="p">:</span> <span class="s2">"sub_block"</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">BLOCK</span>
      <span class="n">block_idx</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
    <span class="n">attrs</span> <span class="p">{</span>
      <span class="n">name</span><span class="p">:</span> <span class="s2">"cases"</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">STRINGS</span>
      <span class="n">strings</span><span class="p">:</span> <span class="s2">"0,1,channel_101,fill_constant_109.tmp_0"</span>
      <span class="n">strings</span><span class="p">:</span> <span class="s2">"1,2,channel_102,fill_constant_108.tmp_0"</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The python select API will add the <strong>select_op</strong> to the current block.  In addition, it will
iterate through all it’s case statements and add any input variables required by case statements
into <strong>X</strong>.  It will also create a temp variable called <strong>case_to_execute</strong>.  This variable is
filled in by the select_op after it has completed processing the case statements.</p>
<p>If there are no available cases to execute (ie: all cases are blocked on channel operations, and
there is no default statement), then the select_op will block the current thread.  The thread will
unblock once there is a channel operation affecting one of the case statements, at which point, the
<strong>select_op</strong> will set the <strong>case_to_execute</strong> variable to the index of the case to execute.</p>
<p>Finally the select_op will call executor.run on the <strong>sub_block</strong>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">blocks</span> <span class="p">{</span>
  <span class="n">idx</span><span class="p">:</span> <span class="mi">1</span>
  <span class="n">parent_idx</span><span class="p">:</span> <span class="mi">0</span>
  <span class="o">...</span>
  <span class="o">//</span> <span class="n">Fill</span> <span class="n">a</span> <span class="n">tensor</span> <span class="k">with</span> <span class="n">the</span> <span class="n">case</span> <span class="n">index</span> <span class="p">(</span><span class="n">ie</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">ect</span><span class="o">.</span><span class="p">)</span>
  <span class="n">ops</span> <span class="p">{</span>
    <span class="n">outputs</span> <span class="p">{</span>
      <span class="n">parameter</span><span class="p">:</span> <span class="s2">"Out"</span>
      <span class="n">arguments</span><span class="p">:</span> <span class="s2">"fill_constant_111.tmp_0"</span>
    <span class="p">}</span>
    <span class="nb">type</span><span class="p">:</span> <span class="s2">"fill_constant"</span>
    <span class="n">attrs</span> <span class="p">{</span>
      <span class="n">name</span><span class="p">:</span> <span class="s2">"force_cpu"</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">BOOLEAN</span>
      <span class="n">b</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">}</span>
    <span class="n">attrs</span> <span class="p">{</span>
      <span class="n">name</span><span class="p">:</span> <span class="s2">"value"</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">FLOAT</span>
      <span class="n">f</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="p">}</span>
    <span class="n">attrs</span> <span class="p">{</span>
      <span class="n">name</span><span class="p">:</span> <span class="s2">"shape"</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">INTS</span>
      <span class="n">ints</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
    <span class="n">attrs</span> <span class="p">{</span>
      <span class="n">name</span><span class="p">:</span> <span class="s2">"dtype"</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">INT</span>
      <span class="n">i</span><span class="p">:</span> <span class="mi">2</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="o">//</span> <span class="n">Create</span> <span class="n">an</span> <span class="s2">"equal"</span> <span class="n">operator</span> <span class="n">to</span> <span class="n">compare</span> <span class="n">the</span> <span class="n">case</span> <span class="n">index</span> <span class="k">with</span> <span class="n">the</span> <span class="s2">"case_to_execute"</span>
  <span class="o">//</span> <span class="n">tensor</span> <span class="p">(</span><span class="n">which</span> <span class="n">was</span> <span class="n">filled</span> <span class="ow">in</span> <span class="n">by</span> <span class="n">the</span> <span class="n">select</span> <span class="n">op</span><span class="p">)</span><span class="o">.</span>
  <span class="n">ops</span> <span class="p">{</span>
    <span class="n">inputs</span> <span class="p">{</span>
      <span class="n">parameter</span><span class="p">:</span> <span class="s2">"X"</span>
      <span class="n">arguments</span><span class="p">:</span> <span class="s2">"fill_constant_111.tmp_0"</span>  <span class="o">//</span> <span class="n">case</span> <span class="mi">0</span>
    <span class="p">}</span>
    <span class="n">inputs</span> <span class="p">{</span>
      <span class="n">parameter</span><span class="p">:</span> <span class="s2">"Y"</span>
      <span class="n">arguments</span><span class="p">:</span> <span class="s2">"fill_constant_110.tmp_0"</span>  <span class="o">//</span> <span class="n">case_to_execute</span>
    <span class="p">}</span>
    <span class="n">outputs</span> <span class="p">{</span>
      <span class="n">parameter</span><span class="p">:</span> <span class="s2">"Out"</span>
      <span class="n">arguments</span><span class="p">:</span> <span class="s2">"equal_0.tmp_0"</span>
    <span class="p">}</span>
    <span class="nb">type</span><span class="p">:</span> <span class="s2">"equal"</span>
    <span class="n">attrs</span> <span class="p">{</span>
      <span class="n">name</span><span class="p">:</span> <span class="s2">"axis"</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">INT</span>
      <span class="n">i</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="o">//</span> <span class="n">Use</span> <span class="n">the</span> <span class="n">output</span> <span class="n">of</span> <span class="n">the</span> <span class="s2">"equal"</span> <span class="n">operator</span> <span class="k">as</span> <span class="n">a</span> <span class="n">condition</span> <span class="k">for</span> <span class="n">the</span> <span class="s2">"conditional_block"</span><span class="o">.</span>
  <span class="o">//</span> <span class="n">If</span> <span class="n">the</span> <span class="n">condition</span> <span class="n">evaluates</span> <span class="n">to</span> <span class="n">true</span><span class="p">,</span> <span class="n">then</span> <span class="n">execute</span> <span class="n">the</span> <span class="s2">"sub_block"</span> <span class="p">(</span><span class="n">which</span> <span class="n">represents</span>
  <span class="o">//</span> <span class="n">the</span> <span class="n">select</span> <span class="n">case</span><span class="s1">'s body)</span>
  <span class="n">ops</span> <span class="p">{</span>
    <span class="n">inputs</span> <span class="p">{</span>
      <span class="n">parameter</span><span class="p">:</span> <span class="s2">"Params"</span>
    <span class="p">}</span>
    <span class="n">inputs</span> <span class="p">{</span>
      <span class="n">parameter</span><span class="p">:</span> <span class="s2">"X"</span>
      <span class="n">arguments</span><span class="p">:</span> <span class="s2">"equal_0.tmp_0"</span>
    <span class="p">}</span>
    <span class="n">outputs</span> <span class="p">{</span>
      <span class="n">parameter</span><span class="p">:</span> <span class="s2">"Out"</span>
    <span class="p">}</span>
    <span class="n">outputs</span> <span class="p">{</span>
      <span class="n">parameter</span><span class="p">:</span> <span class="s2">"Scope"</span>
      <span class="n">arguments</span><span class="p">:</span> <span class="s2">"_generated_var_0"</span>
    <span class="p">}</span>
    <span class="nb">type</span><span class="p">:</span> <span class="s2">"conditional_block"</span>
    <span class="n">attrs</span> <span class="p">{</span>
      <span class="n">name</span><span class="p">:</span> <span class="s2">"is_scalar_condition"</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">BOOLEAN</span>
      <span class="n">b</span><span class="p">:</span> <span class="n">true</span>
    <span class="p">}</span>
    <span class="n">attrs</span> <span class="p">{</span>
      <span class="n">name</span><span class="p">:</span> <span class="s2">"sub_block"</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">BLOCK</span>
      <span class="n">block_idx</span><span class="p">:</span> <span class="mi">4</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="o">...</span>
  <span class="o">//</span> <span class="n">Repeat</span> <span class="n">the</span> <span class="n">above</span> <span class="n">operators</span> <span class="k">for</span> <span class="n">each</span> <span class="n">case</span> <span class="n">statements</span> <span class="n">inside</span> <span class="n">the</span> <span class="n">select</span> <span class="n">body</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Cases are represented by a <strong>conditional_block operator</strong>, whose’s condition is set as the output of
equal(<strong>case_to_execute</strong>, <strong>case_index</strong>).  Since each case index is unique in this sub-block,
only one case will be executed.</p>
</div>
<div class="section" id="select-op-flow">
<span id="select-op-flow"></span><h3>select_op flow<a class="headerlink" href="#select-op-flow" title="永久链接至标题">¶</a></h3>
<p align="center">
<img src="https://raw.githubusercontent.com/PaddlePaddle/Paddle/develop/doc/fluid/images/select_op_workflow.png"/><br/>
</p><p>The select algorithm is inspired by golang’s select routine.  Please refer to
http://www.tapirgames.com/blog/golang-concurrent-select-implementation for more information.</p>
</div>
</div>
<div class="section" id="backward-pass">
<span id="backward-pass"></span><h2>Backward Pass<a class="headerlink" href="#backward-pass" title="永久链接至标题">¶</a></h2>
<p>TODO</p>
</div>
</div>
</div>
<div class="articleComments">
</div>
</div>