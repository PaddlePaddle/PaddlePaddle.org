<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div itemprop="articleBody">
<div class="section" id="operator-s-parameter-name-convention">
<span id="operator-s-parameter-name-convention"></span><h1>Operator’s Parameter Name Convention<a class="headerlink" href="#operator-s-parameter-name-convention" title="永久链接至标题">¶</a></h1>
<p>To make the operator document itself more clear, we recommend operator names obey the listing conventions.</p>
<div class="section" id="opprotomaker-names">
<span id="opprotomaker-names"></span><h2>OpProtoMaker names<a class="headerlink" href="#opprotomaker-names" title="永久链接至标题">¶</a></h2>
<p>When defining an operator in Paddle, a corresponding <a class="reference external" href="https://github.com/PaddlePaddle/Paddle/blob/develop/paddle/fluid/framework/operator.h#L170">OpProtoMaker</a> (TODO: OpProtoMaker Doc)need to be defined. All the Input/Output and Attributes will write into the <a class="reference external" href="https://github.com/PaddlePaddle/Paddle/blob/develop/paddle/fluid/framework/framework.proto#L61">OpProto</a> , and will be used in client language to create operator.</p>
<ul class="simple">
<li>Input/Output.<ul>
<li>Input/Output names follow the <strong>CamelCase</strong>. e.g. <code class="docutils literal"><span class="pre">X</span></code>, <code class="docutils literal"><span class="pre">Y</span></code>, <code class="docutils literal"><span class="pre">Matrix</span></code>, <code class="docutils literal"><span class="pre">LastAxisInMatrix</span></code>. Input/Output much more like Variables, we prefer to meaningful English words.</li>
<li>If an operator’s Input/Output are tensors in math, not match to any meaningful words, input name should starts from <code class="docutils literal"><span class="pre">X</span></code>. e.g. <code class="docutils literal"><span class="pre">X</span></code>, <code class="docutils literal"><span class="pre">Y</span></code>, and output name should starts from <code class="docutils literal"><span class="pre">Out</span></code>. e.g. <code class="docutils literal"><span class="pre">Out</span></code>. This rule intends making operators which have few inputs/outputs unified.</li>
</ul>
</li>
<li>Attribute.<ul>
<li>Attribute name follows the <strong>snake_case</strong>. e.g. <code class="docutils literal"><span class="pre">x</span></code>, <code class="docutils literal"><span class="pre">y</span></code>, <code class="docutils literal"><span class="pre">axis</span></code>, <code class="docutils literal"><span class="pre">rowwise_matrix</span></code>. Also, attribute name prefers to meaningful English words.</li>
</ul>
</li>
<li>Comments.<ul>
<li>Input/Output/Attr comment follow the format of <strong>(type,default value) usage</strong>, corresponding to which type it can be and how it will be used in the operator. e.g.  Attribute in Accumulator<code class="docutils literal"><span class="pre">"gamma"</span></code>,<code class="docutils literal"><span class="pre">(float,</span> <span class="pre">default</span> <span class="pre">1.0)</span> <span class="pre">Accumulation</span> <span class="pre">multiplier</span></code>.</li>
<li>Operator comment format of<code class="docutils literal"><span class="pre">R"DOC(your</span> <span class="pre">comment</span> <span class="pre">here)DOC"</span></code>. You should explain the input/output of the operator first. If there is math calculation in this operator, you should write the equation in the comment. e.g. <code class="docutils literal"><span class="pre">Out</span> <span class="pre">=</span> <span class="pre">X</span> <span class="pre">+</span> <span class="pre">Y</span></code>.</li>
</ul>
</li>
<li>Order.<ul>
<li>Follow the order of Input/Output, then Attribute, then Comments. See the example in best practice.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="best-practice">
<span id="best-practice"></span><h2>Best Practice<a class="headerlink" href="#best-practice" title="永久链接至标题">¶</a></h2>
<p>Here we give some examples to show how these rules will be used.</p>
<ul>
<li><p class="first">The operator has one input, one output. e.g.<code class="docutils literal"><span class="pre">relu</span></code>, inputs: <code class="docutils literal"><span class="pre">X</span></code>, outputs: <code class="docutils literal"><span class="pre">Out</span></code>.</p>
</li>
<li><p class="first">The operator has two input, one output. e.g. <code class="docutils literal"><span class="pre">rowwise_add</span></code>, inputs : <code class="docutils literal"><span class="pre">X</span></code>, <code class="docutils literal"><span class="pre">Y</span></code>, outputs : <code class="docutils literal"><span class="pre">Out</span></code>.</p>
</li>
<li><p class="first">The operator contains attribute. e.g. <code class="docutils literal"><span class="pre">cosine</span></code>, inputs : <code class="docutils literal"><span class="pre">X</span></code>, <code class="docutils literal"><span class="pre">axis</span></code>, outputs : <code class="docutils literal"><span class="pre">Out</span></code>.</p>
<p>We give a full example of Accumulator Operator.</p>
</li>
</ul>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AccumulateOpMaker</span> <span class="o">:</span> <span class="k">public</span> <span class="n">framework</span><span class="o">::</span><span class="n">OpProtoAndCheckerMaker</span> <span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
  <span class="n">AccumulateOpMaker</span><span class="p">(</span><span class="n">OpProto</span> <span class="o">*</span><span class="n">proto</span><span class="p">,</span>
                    <span class="n">OpAttrChecker</span> <span class="o">*</span><span class="n">op_checker</span><span class="p">)</span>
    <span class="o">:</span> <span class="n">OpProtoAndCheckerMaker</span><span class="p">(</span><span class="n">proto</span><span class="p">,</span> <span class="n">op_checker</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">AddInput</span><span class="p">(</span><span class="s">"X"</span><span class="p">,</span> <span class="s">"(Tensor) The input tensor that has to be accumulated to the output tensor.</span>
    <span class="n">If</span> <span class="n">the</span> <span class="n">output</span> <span class="n">size</span> <span class="n">is</span> <span class="n">not</span> <span class="n">the</span> <span class="n">same</span> <span class="n">as</span> <span class="n">input</span> <span class="n">size</span><span class="p">,</span>
    <span class="n">the</span> <span class="n">output</span> <span class="n">tensor</span> <span class="n">is</span> <span class="n">first</span> <span class="n">reshaped</span> <span class="n">and</span> <span class="n">initialized</span> <span class="n">to</span> <span class="n">zero</span><span class="p">,</span> <span class="n">and</span> <span class="n">only</span> <span class="n">then</span><span class="p">,</span> <span class="n">accumulation</span> <span class="n">is</span> <span class="n">done</span><span class="p">.</span><span class="s">");</span>
    <span class="n">AddOutput</span><span class="p">(</span><span class="s">"Out"</span><span class="p">,</span> <span class="s">"(Tensor) Accumulated output tensor"</span><span class="p">);</span>
    <span class="n">AddAttr</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"gamma"</span><span class="p">,</span> <span class="s">"(float, default 1.0) Accumulation multiplier"</span><span class="p">).</span><span class="n">SetDefault</span><span class="p">(</span><span class="mf">1.0f</span><span class="p">);</span>
    <span class="n">AddComment</span><span class="p">(</span><span class="sa">R</span><span class="s">"</span><span class="dl">DOC(</span><span class="s"></span>
<span class="s">Accumulate Operator.</span>

<span class="s">This operator accumulates the input tensor to the output tensor. If the</span>
<span class="s">output tensor already has the right size, we add to it; otherwise, we first</span>
<span class="s">initialize the output tensor to all zeros, and then do accumulation. Any</span>
<span class="s">further calls to the operator, given that no one else fiddles with the output</span>
<span class="s">in the interim, will do simple accumulations.</span>

<span class="s">Accumulation is done as follows:</span>

<span class="s">Out = 1*X + gamma*Out</span>

<span class="s">where X is the input tensor, Out is the output tensor and gamma is the multiplier</span>
<span class="s">argument.</span>

<span class="dl">)DOC</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="articleComments">
</div>
</div>